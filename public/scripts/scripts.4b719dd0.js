"use strict";angular.module("chariotApp",["ngAnimate","ngCookies","ngResource","ngRoute","ngSanitize","ngTouch","ng-token-auth"]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/main.html",controller:"MainCtrl"}).when("/sign_in",{templateUrl:"views/user_sessions/new.html",controller:"UserSessionsCtrl"}).when("/sign_up",{templateUrl:"views/user_registrations/new.html",controller:"UserRegistrationsCtrl"}).when("/rides",{templateUrl:"views/rides.html",controller:"RidesCtrl",resolve:{auth:["$auth",function(a){return a.validateUser()}]}}).when("/about",{templateUrl:"views/about.html",controller:"AboutCtrl"}).otherwise({redirectTo:"/"})}]).run(["$rootScope","$location",function(a,b){a.$on("auth:login-success",function(){b.path("/")})}]),angular.module("chariotApp").controller("MainCtrl",["$scope",function(a){a.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]}]),angular.module("chariotApp").controller("AboutCtrl",["$scope",function(a){a.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]}]),angular.module("chariotApp").controller("UserSessionsCtrl",["$scope",function(a){a.$on("auth:login-error",function(b,c){a.error=c.errors[0]})}]),angular.module("chariotApp").controller("UserRegistrationsCtrl",["$scope","$auth",function(a,b){a.handleRegBtnClick=function(){b.submitRegistration(a.registrationForm).then(function(){b.submitLogin({email:a.registrationForm.email,password:a.registrationForm.password})})},a.$on("auth:registration-email-error",function(b,c){a.error=c.errors[0]})}]),angular.module("chariotApp").controller("RidesCtrl",["$scope","$rootScope","RidesService",function(a,b,c){a.geolocation=function(){navigator?(a.positionMessage="Loading...",navigator.geolocation.getCurrentPosition(function(d){b.$apply(function(){a.positionMessage="Latitude: "+d.coords.latitude+" Longitude: "+d.coords.longitude,c.postCoords(d).success(function(){console.log("postCoords returned success")}).error(function(){alert("postCoords ERROR")})})})):b.$apply(function(){a.positionMessage="Geolocation is not supported"})}}]),angular.module("chariotApp").service("RidesService",["$http",function(a){this.postCoords=function(b){console.log("postCords called with fullPosition = "+JSON.stringify(b));var c={latitude:b.coords.latitude,longitude:b.coords.longitude};return console.log("sending to server a position = "+JSON.stringify(c)),a.post("/api/rides",{ride:c})}}]);